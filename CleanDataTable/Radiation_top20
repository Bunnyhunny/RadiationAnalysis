DROP TABLE IF EXISTS radiation_top20;
CREATE EXTERNAL TABLE radiation_top20 (time int, lat double, long double, value double)
ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
STORED AS TEXTFILE LOCATION '/user/xliang18/radiation/table/radiation_top20';
INSERT OVERWRITE TABLE radiation_top20
SELECT time, round(lat,1), round(long,1), max(value) as value
FROM radiation_clean
GROUP BY time, round(lat,1), round(long,1) ORDER BY value desc limit 20;


select * from radiation_top20;
